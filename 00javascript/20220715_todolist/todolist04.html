<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>todolist04</title>
    <link rel="stylesheet" href="../../css/reset.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <style>
        .view{width: 400px;}
        .view li{position: relative;}
        .txt{line-height: 40px;background-color: pink;padding: 0 10px;border-radius: 10px;}
        .txt.active{background-color: skyblue;}
        .icon{display: flex;position: absolute;top: 50%;right: 10px;transform: translateY(-50%);}
        .icon a{display: flex;width: 30px;height: 30px;background-color: aqua;border-radius: 50%;justify-content: center;align-items: center;}
    </style>

<body>
    <input type="text" name="" class="inp">
    <button class="btn1">오늘의 할일</button>
    <button class="btn2">전체삭제</button>
    <ul class="view">
        <li>
            <div class="txt">123</div>
            <div class="icon">
                <a href=""onclick = del(${i})>del</a>
                <a href=""onclick = done(${i})>on</a>
                <a href=""onclick = done(${i})>off</a>
            </div>
        </li>
    </ul>




    
    <script>

        listData = [];
        let inp = document.querySelector(".inp")
        let btn1 = document.querySelector(".btn1")
        let btn2 = document.querySelector(".btn2")
        let viewData = document.querySelector(".view")

        btn1.addEventListener("click",function(){
            if(inp.value != ""){
                let value = {"todo":inp.value,"done":false};
                listData.push(value)

                let valueData = JSON.stringify(listData)
                localStorage.setItem("todoData",valueData)

                inp.value = ""
                console.log(value)
                view();
  
            }else{
                alert("오늘의 할일을 입력하시오.")
            }
        })

        function view(){
            if(localStorage.length>0){
                let localData =  localStorage.getItem("todoData")
                listData = JSON.parse(localData)
            }


            let todolist = ""
            listData.forEach(function(item,i){
                todolist += `<li>`
                    if(item.done == true){
                        todolist += `<div class="txt active">${item.todo}</div>`
                    }else{
                        todolist += `<div class="txt">${item.todo}</div>`
                    }
               
                todolist += `<div class="icon">`
                todolist += `<a href="#"onclick = del(${i})>del</a>`
                if(item.done == true){
                    todolist += `<a href="#"onclick = done(${i})>off</a>`
                }else{
                    todolist += `<a href="#"onclick = done(${i})>on</a>`
                }
                todolist += `</div>`
                todolist += `</li>`
                viewData.innerHTML = todolist;
                Adel()
            })
        }

        function Adel(){
            btn2.addEventListener("click",function(){
                listData = [];
                todolist = ""

                let valueData = JSON.stringify(listData);
                localStorage.setItem("todoData",valueData);
                
                viewData.innerHTML = todolist;
                
                
            })
        }

        function del(idx){
            listData.splice(idx,1)

            let valueData = JSON.stringify(listData);
            localStorage.setItem("todoData",valueData);
            view()
        }

        function done(idx){
            listData[idx].done = !listData[idx].done

            let valueData = JSON.stringify(listData);
            localStorage.setItem("todoData",valueData);
            view()
        }


    </script>
</body>



</html>